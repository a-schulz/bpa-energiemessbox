workspace "Monitoring System" "Modell basierend auf dem Diagramm mit Benutzerinteraktion" {

    !identifiers hierarchical

    model {
        mitarbeiter = person "Mitarbeiter" {
            description "Trägt den Handschuh und erhält Warnungen via Vibration."
        }

        system = softwareSystem "Überwachungssystem" {
            description "Erfasst Energie- und Luftdaten, wertet sie aus und leitet Warnungen weiter."

            energiemessbox = container "Energiemessbox" {
                technology "OPC UA"
                description "Liefert Messdaten zu Druck und Luftfluss."
            }

            nodered = container "NodeRed" {
                technology "NodeRed (Flow-basiert)"
                description "Liest Messdaten via OPC UA und REST, publiziert sie weiter."
            }

            rnhd = container "RNHD" {
                technology "REST API"
                description "Liefert Positionsdaten."
            }

            messageBroker = container "MessageBroker" {
                technology "MQTT"
                description "Empfangen und Senden von Daten."
            }

            handschuh = container "Handschuh" {
                description "Empfängt Warnungen und gibt Vibration als Feedback an den Mitarbeiter."
            }

            aas = container "AAS" {
                description "Empfängt Druckluftdaten."
            }
            drools = container "Drools"{
                description "Wertet Geschäftsregeln aus."
            }

            energiemessbox -> nodered "rPressure, rFlow via OPCUA"
            rnhd -> nodered "Positionsdaten via REST"
            nodered -> aas "REST POST: Air"
            nodered -> aas "REST POST: Position"
            nodered -> drools "REST POST: Air and Position"
            nodered -> aas "REST POST: Malfunction "
            messageBroker -> handschuh "subscribe Topic: Warning, Service Level 2"
            messageBroker -> aas "subscribe Topic: AAS, Service Level 1"
            aas -> messageBroker "subscribe Topic: Air , Service Level 1"
            handschuh -> mitarbeiter "sendet Warnung (Vibration)"
            drools -> nodered "REST POST Response: Malfunction"
        }
    }

    views {
        container system "MonitoringContainerDiagram" {
            include *
            autolayout lr
        }

        styles {
            element "Person" {
                shape person
                background #116611
                color white
            }

            element "Container" {
                background #4682B4
                color white
            }
        }
    }
}
